local TweenService = game:GetService("TweenService")

function TP(Pos)
    local player = game.Players.LocalPlayer
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local humanoidRootPart = player.Character.HumanoidRootPart
        
        -- หาตำแหน่งเริ่มต้น (CFrame)
        local startPos = humanoidRootPart.CFrame
        
        -- กำหนดข้อมูลสำหรับการเคลื่อนไหว (Tween)
        local tweenInfo = TweenInfo.new(
            0.5, -- ระยะเวลาการเคลื่อนไหว (0.5 วินาที)
            Enum.EasingStyle.Linear, -- รูปแบบการเคลื่อนไหว (Linear)
            Enum.EasingDirection.InOut, -- การเปลี่ยนทิศทางการเคลื่อนไหว (InOut)
            0, -- จำนวนครั้งในการทำซ้ำ
            false, -- ไม่ทำซ้ำ
            0 -- ไม่มีการหน่วงเวลา
        )

        -- สร้าง tween (เคลื่อนไหวจากตำแหน่งเริ่มต้นไปยังตำแหน่งใหม่)
        local tweenGoal = {CFrame = Pos}
        local tween = TweenService:Create(humanoidRootPart, tweenInfo, tweenGoal)

        -- เริ่มการเคลื่อนไหว
        tween:Play()

        -- รอจนกว่าเคลื่อนไหวเสร็จ
        tween.Completed:Wait()
    end
end

local Monfolder = workspace.Monster:FindFirstChild("Mon")
if not Monfolder then return end

function Attack()
    local args = {
        [1] = "FS_None_M1"
    }
    game:GetService("ReplicatedStorage"):WaitForChild("Chest"):WaitForChild("Remotes"):WaitForChild("Functions"):WaitForChild("SkillAction"):InvokeServer(unpack(args))
end

function Checkquest()
    local args = {
        [1] = "take",
        [2] = "Kill 4 Soldiers"
    }
    game:GetService("ReplicatedStorage"):WaitForChild("Chest"):WaitForChild("Remotes"):WaitForChild("Functions"):WaitForChild("Quest"):InvokeServer(unpack(args))
end

_G.AutoFarm = true

while task.wait() do
    pcall(function()
        if _G.AutoFarm then
            local Monfolder = workspace.Monster:FindFirstChild("Mon")
            if Monfolder then
                for _, v in pairs(Monfolder:GetChildren()) do
                    if v.Name == "Soldier [Lv. 1]" then
                        local humanoid = v:FindFirstChild("Humanoid")
                        local hrp = v:FindFirstChild("HumanoidRootPart")
                        if humanoid and humanoid.Health > 0 and hrp then
                            humanoid.PlatformStand = true  -- ปิดการเคลื่อนไหวของ humanoid
                            
                            -- วาร์ปไปตำแหน่งของมอนสเตอร์
                            TP(hrp.CFrame * CFrame.new(0, 0, 6))  -- วาร์ปไปที่มอนสเตอร์

                            -- โจมตีจนกว่ามอนสเตอร์จะตาย
                            repeat
                                task.wait(0.1)  -- เพิ่มเวลาระหว่างการโจมตี
                                if v.Name == "Soldier [Lv. 1]" then
                                    Attack()  -- โจมตี
                                end
                            until humanoid.Health <= 0  -- หยุดเมื่อมอนสเตอร์ตาย
                            
                            humanoid.PlatformStand = false  -- เปิดการเคลื่อนไหวกลับคืน
                        end
                    end
                end
            end
        end
    end)
end
